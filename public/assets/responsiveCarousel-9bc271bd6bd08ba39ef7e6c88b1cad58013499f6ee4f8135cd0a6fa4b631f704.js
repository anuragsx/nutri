!function(i){"use strict";i.fn.carousel=function(e){var t,a;return t={infinite:!0,visible:1,speed:"slow",overflow:!1,autoRotate:!1,navigation:i(this).data("navigation"),itemMinWidth:0,itemEqualHeight:!1,itemMargin:0,itemClassActive:"crsl-active",imageWideClass:"wide-image",carousel:!0},i(this).each(function(){a=i(this),i.isEmptyObject(e)===!1&&i.extend(t,e),i.isEmptyObject(i(a).data("crsl"))===!1&&i.extend(t,i(a).data("crsl")),t.isTouch=!!("ontouchstart"in document.documentElement||navigator.userAgent.match(/Android|BlackBerry|iPhone|iPad|iPod|Opera Mini|IEMobile/i)),a.init=function(){t.total=i(a).find(".crsl-item").length,t.itemWidth=i(a).outerWidth(),t.visibleDefault=t.visible,t.swipeDistance=null,t.swipeMinDistance=100,t.startCoords={},t.endCoords={},i(a).css({width:"100%"}),i(a).find(".crsl-item").css({position:"relative","float":"left",overflow:"hidden",height:"auto"}),i(a).find("."+t.imageWideClass).each(function(){i(this).css({display:"block",width:"100%",height:"auto"})}),i(a).find(".crsl-item iframe").attr({width:"100%"}),t.carousel&&i(a).find(".crsl-item:first-child").addClass(t.itemClassActive),t.carousel&&t.infinite&&t.visible<t.total&&i(a).find(".crsl-item:first-child").before(i(".crsl-item:last-child",a)),t.overflow===!1?i(a).css({overflow:"hidden"}):i("html, body").css({"overflow-x":"hidden"}),i(a).trigger("initCarousel",[t,a]),a.testPreload(),a.config(),a.initRotate(),a.triggerNavs()},a.testPreload=function(){if(i(a).find("img").length>0){var e=i(a).find("img").length,n=1;i(a).find("img").each(function(){a.preloadImage(this,n,e),n++})}else i(a).trigger("loadedCarousel",[t,a])},a.preloadImage=function(e,n,r){var s=new Image,o={};o.src=i(e).attr("src")!==undefined?e.src:"",o.alt=i(e).attr("alt")!==undefined?e.alt:"",i(s).attr(o),i(s).on("load",function(){1===n&&i(a).trigger("loadingImagesCarousel",[t,a]),n===r&&i(a).trigger("loadedImagesCarousel",[t,a])})},a.config=function(){t.itemWidth=Math.floor((i(a).outerWidth()-t.itemMargin*(t.visibleDefault-1))/t.visibleDefault),t.itemWidth<=t.itemMinWidth?(t.visible=1===Math.floor((i(a).outerWidth()-t.itemMargin*(t.visible-1))/t.itemMinWidth)?Math.floor(i(a).outerWidth()/t.itemMinWidth):Math.floor((i(a).outerWidth()-t.itemMargin)/t.itemMinWidth),t.visible=t.visible<1?1:t.visible,t.itemWidth=1===t.visible?Math.floor(i(a).outerWidth()):Math.floor((i(a).outerWidth()-t.itemMargin*(t.visible-1))/t.visible)):t.visible=t.visibleDefault,t.carousel?(a.wrapWidth=Math.floor((t.itemWidth+t.itemMargin)*t.total),a.wrapMargin=a.wrapMarginDefault=t.infinite&&t.visible<t.total?parseInt((t.itemWidth+t.itemMargin)*-1,10):0,t.infinite&&t.visible<t.total&&0===i(a).find(".crsl-item."+t.itemClassActive).index()&&(i(a).find(".crsl-item:first-child").before(i(".crsl-item:last-child",a)),a.wrapMargin=a.wrapMarginDefault=parseInt((t.itemWidth+t.itemMargin)*-1,10)),i(a).find(".crsl-wrap").css({width:a.wrapWidth+"px",marginLeft:a.wrapMargin})):(a.wrapWidth=i(a).outerWidth(),i(a).find(".crsl-wrap").css({width:a.wrapWidth+t.itemMargin+"px"}),i("#"+t.navigation).hide()),i(a).find(".crsl-item").css({width:t.itemWidth+"px",marginRight:t.itemMargin+"px"}),a.equalHeights(),t.carousel&&(t.visible>=t.total?(t.autoRotate=!1,i("#"+t.navigation).hide()):i("#"+t.navigation).show())},a.equalHeights=function(){if(t.itemEqualHeight!==!1){var e=0;i(a).find(".crsl-item").each(function(){i(this).css({height:"auto"}),i(this).outerHeight()>e&&(e=i(this).outerHeight())}),i(a).find(".crsl-item").css({height:e+"px"})}return!0},a.initRotate=function(){t.autoRotate!==!1&&(a.rotateTime=window.setInterval(function(){a.rotate()},t.autoRotate))},a.triggerNavs=function(){i("#"+t.navigation).delegate(".previous, .next","click",function(e){if(e.preventDefault(),a.prepareExecute(),i(this).hasClass("previous")&&a.testPrevious(a.itemActive))a.previous();else{if(!i(this).hasClass("next")||!a.testNext())return;a.next()}})},a.prepareExecute=function(){return t.autoRotate&&clearInterval(a.rotateTime),a.preventAnimateEvent(),a.itemActive=i(a).find(".crsl-item."+t.itemClassActive),!0},a.preventAnimateEvent=function(){if(i(a).find(".crsl-wrap:animated").length>0)return!1},a.rotate=function(){return a.preventAnimateEvent(),a.itemActive=i(a).find(".crsl-item."+t.itemClassActive),a.next(),!0},a.testPrevious=function(e){return i(".crsl-wrap",a).find(".crsl-item").index(e)>0},a.testNext=function(){return!t.infinite&&a.wrapWidth>=(t.itemWidth+t.itemMargin)*(t.visible+1)-a.wrapMargin||t.infinite},a.previous=function(){a.wrapMargin=t.infinite?a.wrapMarginDefault+i(a.itemActive).outerWidth(!0):a.wrapMargin+i(a.itemActive).outerWidth(!0);var e=(i(a.itemActive).index(),i(a.itemActive).prev(".crsl-item")),n="previous";i(a).trigger("beginCarousel",[t,a,n]),i(a).find(".crsl-wrap").animate({marginLeft:a.wrapMargin+"px"},t.speed,function(){i(a.itemActive).removeClass(t.itemClassActive),i(e).addClass(t.itemClassActive),t.infinite?i(this).css({marginLeft:a.wrapMarginDefault}).find(".crsl-item:first-child").before(i(".crsl-item:last-child",a)):(a.testPrevious(e)===!1&&i("#"+t.navigation).find(".previous").addClass("previous-inactive"),a.testNext()&&i("#"+t.navigation).find(".next").removeClass("next-inactive")),i(this).trigger("endCarousel",[t,a,n])})},a.next=function(){a.wrapMargin=t.infinite?a.wrapMarginDefault-i(a.itemActive).outerWidth(!0):a.wrapMargin-i(a.itemActive).outerWidth(!0);var e=(i(a.itemActive).index(),i(a.itemActive).next(".crsl-item")),n="next";i(a).trigger("beginCarousel",[t,a,n]),i(a).find(".crsl-wrap").animate({marginLeft:a.wrapMargin+"px"},t.speed,function(){i(a.itemActive).removeClass(t.itemClassActive),i(e).addClass(t.itemClassActive),t.infinite?i(this).css({marginLeft:a.wrapMarginDefault}).find(".crsl-item:last-child").after(i(".crsl-item:first-child",a)):(a.testPrevious(e)&&i("#"+t.navigation).find(".previous").removeClass("previous-inactive"),a.testNext()===!1&&i("#"+t.navigation).find(".next").addClass("next-inactive")),i(this).trigger("endCarousel",[t,a,n])})};var n,r=!1;i(window).on("mouseleave",function(e){return e.target?n=e.target:e.srcElement&&(n=e.srcElement),r=!!(i(a).attr("id")&&i(n).parents(".crsl-items").attr("id")===i(a).attr("id")||i(n).parents(".crsl-items").data("navigation")===i(a).data("navigation")),!1}),i(window).on("keydown",function(i){r===!0&&(37===i.keyCode?(a.prepareExecute(),a.previous()):39===i.keyCode&&(a.prepareExecute(),a.next()))}),t.isTouch&&i(a).on("touchstart",function(e){i(a).addClass("touching"),t.startCoords.pageX=t.endCoords.pageX=e.originalEvent.targetTouches[0].pageX,t.startCoords.pageY=t.endCoords.pageY=e.originalEvent.targetTouches[0].pageY,i(".touching").on("touchmove",function(i){t.endCoords.pageX=i.originalEvent.targetTouches[0].pageX,t.endCoords.pageY=i.originalEvent.targetTouches[0].pageY,Math.abs(parseInt(t.endCoords.pageX-t.startCoords.pageX,10))>Math.abs(parseInt(t.endCoords.pageY-t.startCoords.pageY,10))&&(i.preventDefault(),i.stopPropagation())})}).on("touchend",function(e){e.preventDefault(),e.stopPropagation(),t.swipeDistance=t.endCoords.pageX-t.startCoords.pageX,t.swipeDistance>=t.swipeMinDistance?(a.prepareExecute(),a.previous()):t.swipeDistance<=-t.swipeMinDistance&&(a.prepareExecute(),a.next()),i(".touching").off("touchmove").removeClass("touching")}),i(a).on("loadedCarousel loadedImagesCarousel",function(){a.equalHeights()}),i(window).on("carouselResizeEnd",function(){t.itemWidth!==i(a).outerWidth()&&a.config()}),i(window).ready(function(){i(a).trigger("prepareCarousel",[t,a]),a.init(),i(window).on("resize",function(){this.carouselResizeTo&&clearTimeout(this.carouselResizeTo),this.carouselResizeTo=setTimeout(function(){i(this).trigger("carouselResizeEnd")},10)})}),i(window).load(function(){a.testPreload(),a.config()})})}}(jQuery);